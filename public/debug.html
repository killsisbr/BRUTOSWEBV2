<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug de Imagens</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f0f0f0;
    }
    .image-test {
      margin: 20px 0;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    img {
      max-width: 300px;
      height: auto;
      border: 2px solid #ddd;
    }
    .error {
      color: red;
      font-weight: bold;
    }
    .success {
      color: green;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Debug de Imagens</h1>
  
  <div class="image-test">
    <h2>Teste 1: Imagem de um produto específico</h2>
    <p>Imagem: /uploads/lanches-especiais/brutus-burguer.png</p>
    <img id="test1" src="/uploads/lanches-especiais/brutus-burguer.png" alt="Teste 1" onerror="handleError(this, 'Teste 1')" onload="handleSuccess(this, 'Teste 1')">
    <p id="result1"></p>
  </div>
  
  <div class="image-test">
    <h2>Teste 2: Imagem de outro produto</h2>
    <p>Imagem: /uploads/lanches-especiais/brutus-salada.png</p>
    <img id="test2" src="/uploads/lanches-especiais/brutus-salada.png" alt="Teste 2" onerror="handleError(this, 'Teste 2')" onload="handleSuccess(this, 'Teste 2')">
    <p id="result2"></p>
  </div>
  
  <div class="image-test">
    <h2>Teste 3: Imagem com caminho absoluto</h2>
    <p>Imagem: http://localhost:3005/uploads/lanches-especiais/brutus-burguer.png</p>
    <img id="test3" src="http://localhost:3005/uploads/lanches-especiais/brutus-burguer.png" alt="Teste 3" onerror="handleError(this, 'Teste 3')" onload="handleSuccess(this, 'Teste 3')">
    <p id="result3"></p>
  </div>
  
  <div class="image-test">
    <h2>Teste 4: Imagem que não existe</h2>
    <p>Imagem: /uploads/nao-existe.png</p>
    <img id="test4" src="/uploads/nao-existe.png" alt="Teste 4" onerror="handleError(this, 'Teste 4')" onload="handleSuccess(this, 'Teste 4')">
    <p id="result4"></p>
  </div>

  <script>
    function handleError(img, testName) {
      document.getElementById(`result${testName.slice(-1)}`).innerHTML = `<span class="error">${testName} - Falhou ao carregar</span>`;
      console.error(`${testName} - Erro ao carregar imagem:`, img.src);
    }
    
    function handleSuccess(img, testName) {
      document.getElementById(`result${testName.slice(-1)}`).innerHTML = `<span class="success">${testName} - Carregada com sucesso</span>`;
      console.log(`${testName} - Imagem carregada com sucesso:`, img.src);
    }
    
    // Testar acesso à API de produtos
    fetch('/api/produtos')
      .then(response => response.json())
      .then(data => {
        console.log('Produtos carregados da API:', data);
        const produtosContainer = document.createElement('div');
        produtosContainer.className = 'image-test';
        produtosContainer.innerHTML = `
          <h2>Produtos da API</h2>
          <p>Total de produtos: ${data.length}</p>
          <div id="produtos-list"></div>
        `;
        document.body.appendChild(produtosContainer);
        
        const list = document.getElementById('produtos-list');
        data.slice(0, 5).forEach((produto, index) => {
          const produtoDiv = document.createElement('div');
          produtoDiv.style.margin = '10px 0';
          produtoDiv.innerHTML = `
            <p><strong>${produto.nome}</strong></p>
            <p>Imagem: ${produto.imagem || 'Nenhuma'}</p>
            ${produto.imagem ? `<img src="${produto.imagem}" style="max-width: 200px; height: auto;" onerror="console.error('Erro ao carregar imagem do produto:', '${produto.nome}')" onload="console.log('Imagem do produto carregada:', '${produto.nome}')">` : ''}
          `;
          list.appendChild(produtoDiv);
        });
      })
      .catch(error => {
        console.error('Erro ao carregar produtos:', error);
      });
  </script>
</body>
</html>